{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/rajku/OneDrive/Desktop/IOt/Profile_update_MERN_project/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/rajku/OneDrive/Desktop/IOt/Profile_update_MERN_project/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import axios from'axios';import jwt_decode from'jwt-decode';// axios.defaults.baseURL = process.env.REACT_APP_SERVER_DOMAIN;\n/** Make API Requests */ /** To get username from Token */export function getUsername(){return _getUsername.apply(this,arguments);}/** authenticate function */function _getUsername(){_getUsername=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var token,decode;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:token=localStorage.getItem('token');if(token){_context.next=3;break;}return _context.abrupt(\"return\",Promise.reject(\"Cannot find Token\"));case 3:decode=jwt_decode(token);return _context.abrupt(\"return\",decode);case 5:case\"end\":return _context.stop();}}},_callee);}));return _getUsername.apply(this,arguments);}export function authenticate(_x){return _authenticate.apply(this,arguments);}/** get User details */function _authenticate(){_authenticate=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(username){return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return axios.post('https://m-2-qhve.onrender.com/api/authenticate',{username:username});case 3:return _context2.abrupt(\"return\",_context2.sent);case 6:_context2.prev=6;_context2.t0=_context2[\"catch\"](0);return _context2.abrupt(\"return\",{error:\"Username doesn't exist...!\"});case 9:case\"end\":return _context2.stop();}}},_callee2,null,[[0,6]]);}));return _authenticate.apply(this,arguments);}export function getUser(_x2){return _getUser.apply(this,arguments);}/** register user function */function _getUser(){_getUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(_ref){var username,_yield$axios$get,data;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:username=_ref.username;_context3.prev=1;_context3.next=4;return axios.get(\"https://m-2-qhve.onrender.com/api/user/\".concat(username));case 4:_yield$axios$get=_context3.sent;data=_yield$axios$get.data;return _context3.abrupt(\"return\",{data:data});case 9:_context3.prev=9;_context3.t0=_context3[\"catch\"](1);return _context3.abrupt(\"return\",{error:\"Password doesn't Match...!\"});case 12:case\"end\":return _context3.stop();}}},_callee3,null,[[1,9]]);}));return _getUser.apply(this,arguments);}export function registerUser(_x3){return _registerUser.apply(this,arguments);}// Example Axios setup in your frontend code\n/** login function */function _registerUser(){_registerUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(credentials){var response,status,data,msg,errorData,username,email;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;console.log(credentials);// const { data : { msg }, status } = await axios.post(`https://m-2-qhve.onrender.com/api/register`, credentials);\n_context4.next=4;return fetch('https://m-2-qhve.onrender.com/api/register',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(credentials)});case 4:response=_context4.sent;status=response.status;_context4.next=8;return response.json();case 8:data=_context4.sent;msg=data.msg;if(response.ok){_context4.next=15;break;}_context4.next=13;return response.json();case 13:errorData=_context4.sent;throw new Error(\"Error: \".concat(status,\", Message: \").concat(errorData.msg));case 15:// const a=await axios.post(`https://m-2-qhve.onrender.com/api/register`, credentials);\nusername=credentials.username,email=credentials.email;/** send email */if(!(status===201)){_context4.next=20;break;}console.log(\"babu\");_context4.next=20;return axios.post('https://m-2-qhve.onrender.com/api/registerMail',{username:username,userEmail:email,text:msg});case 20:return _context4.abrupt(\"return\",Promise.resolve(msg));case 23:_context4.prev=23;_context4.t0=_context4[\"catch\"](0);return _context4.abrupt(\"return\",Promise.reject({error:_context4.t0}));case 26:case\"end\":return _context4.stop();}}},_callee4,null,[[0,23]]);}));return _registerUser.apply(this,arguments);}export function verifyPassword(_x4){return _verifyPassword.apply(this,arguments);}/** update user profile function */function _verifyPassword(){_verifyPassword=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(_ref2){var username,password,_yield$axios$post,data;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:username=_ref2.username,password=_ref2.password;_context5.prev=1;if(!username){_context5.next=8;break;}_context5.next=5;return axios.post('https://m-2-qhve.onrender.com/api/login',{username:username,password:password});case 5:_yield$axios$post=_context5.sent;data=_yield$axios$post.data;return _context5.abrupt(\"return\",Promise.resolve({data:data}));case 8:_context5.next=13;break;case 10:_context5.prev=10;_context5.t0=_context5[\"catch\"](1);return _context5.abrupt(\"return\",Promise.reject({error:\"Password doesn't Match...!\"}));case 13:case\"end\":return _context5.stop();}}},_callee5,null,[[1,10]]);}));return _verifyPassword.apply(this,arguments);}export function updateUser(_x5){return _updateUser.apply(this,arguments);}/** generate OTP */function _updateUser(){_updateUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(response){var token,data;return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;_context6.next=3;return localStorage.getItem('token');case 3:token=_context6.sent;_context6.next=6;return axios.put('https://m-2-qhve.onrender.com/api/updateuser',response,{headers:{\"Authorization\":\"Bearer \".concat(token)}});case 6:data=_context6.sent;return _context6.abrupt(\"return\",Promise.resolve({data:data}));case 10:_context6.prev=10;_context6.t0=_context6[\"catch\"](0);return _context6.abrupt(\"return\",Promise.reject({error:\"Couldn't Update Profile...!\"}));case 13:case\"end\":return _context6.stop();}}},_callee6,null,[[0,10]]);}));return _updateUser.apply(this,arguments);}export function generateOTP(_x6){return _generateOTP.apply(this,arguments);}/** verify OTP */function _generateOTP(){_generateOTP=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(username){var _yield$axios$get2,code,status,_yield$getUser,email,text;return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.prev=0;_context7.next=3;return axios.get('https://m-2-qhve.onrender.com/api/generateOTP',{params:{username:username}});case 3:_yield$axios$get2=_context7.sent;code=_yield$axios$get2.data.code;status=_yield$axios$get2.status;if(!(status===201)){_context7.next=14;break;}_context7.next=9;return getUser({username:username});case 9:_yield$getUser=_context7.sent;email=_yield$getUser.data.email;text=\"Your Password Recovery OTP is \".concat(code,\". Verify and recover your password.\");_context7.next=14;return axios.post('https://m-2-qhve.onrender.com/api/registerMail',{username:username,userEmail:email,text:text,subject:\"Password Recovery OTP\"});case 14:return _context7.abrupt(\"return\",Promise.resolve(code));case 17:_context7.prev=17;_context7.t0=_context7[\"catch\"](0);return _context7.abrupt(\"return\",Promise.reject({error:_context7.t0}));case 20:case\"end\":return _context7.stop();}}},_callee7,null,[[0,17]]);}));return _generateOTP.apply(this,arguments);}export function verifyOTP(_x7){return _verifyOTP.apply(this,arguments);}/** reset password */function _verifyOTP(){_verifyOTP=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(_ref3){var username,code,_yield$axios$get3,data,status;return _regeneratorRuntime().wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:username=_ref3.username,code=_ref3.code;_context8.prev=1;_context8.next=4;return axios.get('https://m-2-qhve.onrender.com/api/verifyOTP',{params:{username:username,code:code}});case 4:_yield$axios$get3=_context8.sent;data=_yield$axios$get3.data;status=_yield$axios$get3.status;return _context8.abrupt(\"return\",{data:data,status:status});case 10:_context8.prev=10;_context8.t0=_context8[\"catch\"](1);return _context8.abrupt(\"return\",Promise.reject(_context8.t0));case 13:case\"end\":return _context8.stop();}}},_callee8,null,[[1,10]]);}));return _verifyOTP.apply(this,arguments);}export function resetPassword(_x8){return _resetPassword.apply(this,arguments);}function _resetPassword(){_resetPassword=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9(_ref4){var username,password,_yield$axios$put,data,status;return _regeneratorRuntime().wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:username=_ref4.username,password=_ref4.password;_context9.prev=1;_context9.next=4;return axios.put('https://m-2-qhve.onrender.com/api/resetPassword',{username:username,password:password});case 4:_yield$axios$put=_context9.sent;data=_yield$axios$put.data;status=_yield$axios$put.status;return _context9.abrupt(\"return\",Promise.resolve({data:data,status:status}));case 10:_context9.prev=10;_context9.t0=_context9[\"catch\"](1);return _context9.abrupt(\"return\",Promise.reject({error:_context9.t0}));case 13:case\"end\":return _context9.stop();}}},_callee9,null,[[1,10]]);}));return _resetPassword.apply(this,arguments);}","map":{"version":3,"names":["axios","jwt_decode","getUsername","token","localStorage","getItem","Promise","reject","decode","authenticate","username","post","error","getUser","get","data","registerUser","credentials","console","log","fetch","method","headers","body","JSON","stringify","response","status","json","msg","ok","errorData","Error","email","userEmail","text","resolve","verifyPassword","password","updateUser","put","generateOTP","params","code","subject","verifyOTP","resetPassword"],"sources":["C:/Users/rajku/OneDrive/Desktop/IOt/Profile_update_MERN_project/client/src/helper/helper.js"],"sourcesContent":["import axios from 'axios';\nimport jwt_decode from 'jwt-decode';\n\n// axios.defaults.baseURL = process.env.REACT_APP_SERVER_DOMAIN;\n\n\n/** Make API Requests */\n\n\n/** To get username from Token */\nexport async function getUsername(){\n    const token = localStorage.getItem('token')\n    if(!token) return Promise.reject(\"Cannot find Token\");\n    let decode = jwt_decode(token)\n    return decode;\n}\n\n/** authenticate function */\nexport async function authenticate(username){\n    try {\n        return await axios.post('https://m-2-qhve.onrender.com/api/authenticate', { username })\n    } catch (error) {\n        return { error : \"Username doesn't exist...!\"}\n    }\n}\n\n/** get User details */\nexport async function getUser({ username }){\n    try {\n        const { data } = await axios.get(`https://m-2-qhve.onrender.com/api/user/${username}`);\n        return { data };\n    } catch (error) {\n        return { error : \"Password doesn't Match...!\"}\n    }\n}\n\n/** register user function */\nexport async function registerUser(credentials){\n    try {  console.log(credentials)\n        // const { data : { msg }, status } = await axios.post(`https://m-2-qhve.onrender.com/api/register`, credentials);\n        const response = await fetch('https://m-2-qhve.onrender.com/api/register', {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(credentials)\n          });\n          \n          const status = response.status;\n          const data = await response.json();\n          const msg = data.msg;\n          if (!response.ok) {\n            // Response is not OK, handle it\n            const errorData = await response.json();\n            throw new Error(`Error: ${status}, Message: ${errorData.msg}`);\n          }\n        // const a=await axios.post(`https://m-2-qhve.onrender.com/api/register`, credentials);\n\n      \n        \n\n        let { username, email } = credentials;\n\n        /** send email */\n        if(status === 201){\n            console.log(\"babu\")\n            await axios.post('https://m-2-qhve.onrender.com/api/registerMail', { username, userEmail : email, text : msg})\n        }\n\n        return Promise.resolve(msg)\n    } catch (error) {\n        return Promise.reject({ error })\n    }\n}\n\n\n\n// Example Axios setup in your frontend code\n\n\n\n\n\n/** login function */\nexport async function verifyPassword({ username, password }){\n    try {\n        if(username){\n            const { data } = await axios.post('https://m-2-qhve.onrender.com/api/login', { username, password })\n            return Promise.resolve({ data });\n        }\n    } catch (error) {\n        return Promise.reject({ error : \"Password doesn't Match...!\"})\n    }\n}\n\n/** update user profile function */\nexport async function updateUser(response){\n    try {\n        \n        const token = await localStorage.getItem('token');\n        const data = await axios.put('https://m-2-qhve.onrender.com/api/updateuser', response, { headers : { \"Authorization\" : `Bearer ${token}`}});\n\n        return Promise.resolve({ data })\n    } catch (error) {\n        return Promise.reject({ error : \"Couldn't Update Profile...!\"})\n    }\n}\n\n/** generate OTP */\nexport async function generateOTP(username){\n    try {\n        const {data : { code }, status } = await axios.get('https://m-2-qhve.onrender.com/api/generateOTP', { params : { username }});\n\n        // send mail with the OTP\n        if(status === 201){\n            let { data : { email }} = await getUser({ username });\n            let text = `Your Password Recovery OTP is ${code}. Verify and recover your password.`;\n            await axios.post('https://m-2-qhve.onrender.com/api/registerMail', { username, userEmail: email, text, subject : \"Password Recovery OTP\"})\n        }\n        return Promise.resolve(code);\n    } catch (error) {\n        return Promise.reject({ error });\n    }\n}\n\n/** verify OTP */\nexport async function verifyOTP({ username, code }){\n    try {\n       const { data, status } = await axios.get('https://m-2-qhve.onrender.com/api/verifyOTP', { params : { username, code }})\n       return { data, status }\n    } catch (error) {\n        return Promise.reject(error);\n    }\n}\n\n/** reset password */\nexport async function resetPassword({ username, password }){\n    try {\n        const { data, status } = await axios.put('https://m-2-qhve.onrender.com/api/resetPassword', { username, password });\n        return Promise.resolve({ data, status})\n    } catch (error) {\n        return Promise.reject({ error })\n    }\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
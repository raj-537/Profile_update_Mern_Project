{"ast":null,"code":"import _objectSpread from\"C:/Users/rajku/OneDrive/Desktop/IOt/Profile_update_MERN_project/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/rajku/OneDrive/Desktop/IOt/Profile_update_MERN_project/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/rajku/OneDrive/Desktop/IOt/Profile_update_MERN_project/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/rajku/OneDrive/Desktop/IOt/Profile_update_MERN_project/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import avatar from'../assets/profile.png';import toast,{Toaster}from'react-hot-toast';import{useFormik}from'formik';import{profileValidation}from'../helper/validate';import convertToBase64 from'../helper/convert';import useFetch from'../hooks/fetch.hook';import{updateUser}from'../helper/helper';import{useNavigate}from'react-router-dom';import styles from'../styles/Username.module.css';import extend from'../styles/Profile.module.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function Profile(){var _useState=useState(),_useState2=_slicedToArray(_useState,2),file=_useState2[0],setFile=_useState2[1];var _useFetch=useFetch(),_useFetch2=_slicedToArray(_useFetch,1),_useFetch2$=_useFetch2[0],isLoading=_useFetch2$.isLoading,apiData=_useFetch2$.apiData,serverError=_useFetch2$.serverError;var navigate=useNavigate();var formik=useFormik({initialValues:{firstName:(apiData===null||apiData===void 0?void 0:apiData.firstName)||'',lastName:(apiData===null||apiData===void 0?void 0:apiData.lastName)||'',email:(apiData===null||apiData===void 0?void 0:apiData.email)||'',mobile:(apiData===null||apiData===void 0?void 0:apiData.mobile)||'',address:(apiData===null||apiData===void 0?void 0:apiData.address)||''},enableReinitialize:true,validate:profileValidation,validateOnBlur:false,validateOnChange:false,onSubmit:function(){var _onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(values){var updatePromise;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Object.assign(values,{profile:file||(apiData===null||apiData===void 0?void 0:apiData.profile)||''});case 2:values=_context.sent;updatePromise=updateUser(values);toast.promise(updatePromise,{loading:'Updating...',success:/*#__PURE__*/_jsx(\"b\",{children:\"Update Successfully...!\"}),error:/*#__PURE__*/_jsx(\"b\",{children:\"Could not Update!\"})});case 5:case\"end\":return _context.stop();}}},_callee);}));function onSubmit(_x){return _onSubmit.apply(this,arguments);}return onSubmit;}()});/** formik doensn't support file upload so we need to create this handler */var onUpload=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var base64;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return convertToBase64(e.target.files[0]);case 2:base64=_context2.sent;setFile(base64);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function onUpload(_x2){return _ref.apply(this,arguments);};}();// logout handler function\nfunction userLogout(){localStorage.removeItem('token');navigate('/');}if(isLoading)return/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl font-bold\",children:\"isLoading\"});if(serverError)return/*#__PURE__*/_jsx(\"h1\",{className:\"text-xl text-red-500\",children:serverError.message});return/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto\",children:[/*#__PURE__*/_jsx(Toaster,{position:\"top-center\",reverseOrder:false}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-screen\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"\".concat(styles.glass,\" \").concat(extend.glass),style:{width:\"45%\",paddingTop:'3em'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"title flex flex-col items-center\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"text-5xl font-bold\",children:\"Profile\"}),/*#__PURE__*/_jsx(\"span\",{className:\"py-4 text-xl w-2/3 text-center text-gray-500\",children:\"You can update the details.\"})]}),/*#__PURE__*/_jsxs(\"form\",{className:\"py-1\",onSubmit:formik.handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"profile flex justify-center py-4\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"profile\",children:/*#__PURE__*/_jsx(\"img\",{src:(apiData===null||apiData===void 0?void 0:apiData.profile)||file||avatar,className:\"\".concat(styles.profile_img,\" \").concat(extend.profile_img),alt:\"avatar\"})}),/*#__PURE__*/_jsx(\"input\",{onChange:onUpload,type:\"file\",id:\"profile\",name:\"profile\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"textbox flex flex-col items-center gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"name flex w-3/4 gap-10\",children:[/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},formik.getFieldProps('firstName')),{},{className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"FirstName\"})),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},formik.getFieldProps('lastName')),{},{className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"LastName\"}))]}),/*#__PURE__*/_jsxs(\"div\",{className:\"name flex w-3/4 gap-10\",children:[/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},formik.getFieldProps('mobile')),{},{className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"Mobile No.\"})),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},formik.getFieldProps('email')),{},{className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"Email*\"}))]}),/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({},formik.getFieldProps('address')),{},{className:\"\".concat(styles.textbox,\" \").concat(extend.textbox),type:\"text\",placeholder:\"Address\"})),/*#__PURE__*/_jsx(\"button\",{className:styles.btn,type:\"submit\",children:\"Update\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-4\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"text-gray-500\",children:[\"come back later? \",/*#__PURE__*/_jsx(\"button\",{onClick:userLogout,className:\"text-red-500\",to:\"/\",children:\"Logout\"})]})})]})]})})]});}","map":{"version":3,"names":["React","useState","avatar","toast","Toaster","useFormik","profileValidation","convertToBase64","useFetch","updateUser","useNavigate","styles","extend","Profile","file","setFile","isLoading","apiData","serverError","navigate","formik","initialValues","firstName","lastName","email","mobile","address","enableReinitialize","validate","validateOnBlur","validateOnChange","onSubmit","values","Object","assign","profile","updatePromise","promise","loading","success","error","onUpload","e","target","files","base64","userLogout","localStorage","removeItem","message","glass","width","paddingTop","handleSubmit","profile_img","getFieldProps","textbox","btn"],"sources":["C:/Users/rajku/OneDrive/Desktop/IOt/Profile_update_MERN_project/client/src/components/Profile.js"],"sourcesContent":["import React, { useState } from 'react'\nimport avatar from '../assets/profile.png';\nimport toast, { Toaster } from 'react-hot-toast';\nimport { useFormik } from 'formik';\nimport { profileValidation } from '../helper/validate';\nimport convertToBase64 from '../helper/convert';\nimport useFetch from '../hooks/fetch.hook';\nimport { updateUser } from '../helper/helper'\nimport { useNavigate } from 'react-router-dom'\n\nimport styles from '../styles/Username.module.css';\nimport extend from '../styles/Profile.module.css'\n\nexport default function Profile() {\n\n  const [file, setFile] = useState();\n  const [{ isLoading, apiData, serverError }] = useFetch();\n  const navigate = useNavigate()\n \n  const formik = useFormik({\n    initialValues : {\n      firstName : apiData?.firstName || '',\n      lastName: apiData?.lastName || '',\n      email: apiData?.email || '',\n      mobile: apiData?.mobile || '',\n      address : apiData?.address || ''\n    },\n    enableReinitialize: true,\n    validate : profileValidation,\n    validateOnBlur: false,\n    validateOnChange: false,\n    onSubmit : async values => {\n      values = await Object.assign(values, { profile : file || apiData?.profile || ''})\n      let updatePromise = updateUser(values);\n\n      toast.promise(updatePromise, {\n        loading: 'Updating...',\n        success : <b>Update Successfully...!</b>,\n        error: <b>Could not Update!</b>\n      });\n\n    }\n  })\n\n  /** formik doensn't support file upload so we need to create this handler */\n  const onUpload = async e => {\n    const base64 = await convertToBase64(e.target.files[0]);\n    setFile(base64);\n  }\n\n  // logout handler function\n  function userLogout(){\n    localStorage.removeItem('token');\n    navigate('/')\n  }\n\n  if(isLoading) return <h1 className='text-2xl font-bold'>isLoading</h1>;\n  if(serverError) return <h1 className='text-xl text-red-500'>{serverError.message}</h1>\n\n  return (\n    <div className=\"container mx-auto\">\n\n      <Toaster position='top-center' reverseOrder={false}></Toaster>\n\n      <div className='flex justify-center items-center h-screen'>\n        <div className={`${styles.glass} ${extend.glass}`} style={{ width: \"45%\", paddingTop: '3em'}}>\n\n          <div className=\"title flex flex-col items-center\">\n            <h4 className='text-5xl font-bold'>Profile</h4>\n            <span className='py-4 text-xl w-2/3 text-center text-gray-500'>\n                You can update the details.\n            </span>\n          </div>\n\n          <form className='py-1' onSubmit={formik.handleSubmit}>\n              <div className='profile flex justify-center py-4'>\n                  <label htmlFor=\"profile\">\n                    <img src={apiData?.profile || file || avatar} className={`${styles.profile_img} ${extend.profile_img}`} alt=\"avatar\" />\n                  </label>\n                  \n                  <input onChange={onUpload} type=\"file\" id='profile' name='profile' />\n              </div>\n\n              <div className=\"textbox flex flex-col items-center gap-6\">\n                <div className=\"name flex w-3/4 gap-10\">\n                  <input {...formik.getFieldProps('firstName')} className={`${styles.textbox} ${extend.textbox}`} type=\"text\" placeholder='FirstName' />\n                  <input {...formik.getFieldProps('lastName')} className={`${styles.textbox} ${extend.textbox}`} type=\"text\" placeholder='LastName' />\n                </div>\n\n                <div className=\"name flex w-3/4 gap-10\">\n                  <input {...formik.getFieldProps('mobile')} className={`${styles.textbox} ${extend.textbox}`} type=\"text\" placeholder='Mobile No.' />\n                  <input {...formik.getFieldProps('email')} className={`${styles.textbox} ${extend.textbox}`} type=\"text\" placeholder='Email*' />\n                </div>\n\n               \n                  <input {...formik.getFieldProps('address')} className={`${styles.textbox} ${extend.textbox}`} type=\"text\" placeholder='Address' />\n                  <button className={styles.btn} type='submit'>Update</button>\n               \n                  \n              </div>\n\n              <div className=\"text-center py-4\">\n                <span className='text-gray-500'>come back later? <button onClick={userLogout} className='text-red-500' to=\"/\">Logout</button></span>\n              </div>\n\n          </form>\n\n        </div>\n      </div>\n    </div>\n  )\n}\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}